<!DOCTYPE html>
<html lang="ja-jp"><head><meta charset="utf-8">
<meta http-equiv="content-type" content="text/html">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title itemprop="name">GameDev #8 入力システム [Devlog #024] | nishihi6</title>
<meta property="og:title" content="GameDev #8 入力システム [Devlog #024] | nishihi6" />
<meta name="twitter:title" content="GameDev #8 入力システム [Devlog #024] | nishihi6" />
<meta itemprop="name" content="GameDev #8 入力システム [Devlog #024] | nishihi6" />
<meta name="application-name" content="GameDev #8 入力システム [Devlog #024] | nishihi6" />
<meta property="og:site_name" content="nishihi6" />

<meta name="description" content="Minimal Hugo blog theme with light and dark mode support">
<meta itemprop="description" content="Minimal Hugo blog theme with light and dark mode support" />
<meta property="og:description" content="Minimal Hugo blog theme with light and dark mode support" />
<meta name="twitter:description" content="Minimal Hugo blog theme with light and dark mode support" />

<meta property="og:locale" content="ja-jp" />
<meta name="language" content="ja-jp" />



  <meta itemprop="image" content="https://nishihi6.github.io/blog/" />
  <meta property="og:image" content="https://nishihi6.github.io/blog/" />
  <meta name="twitter:image" content="https://nishihi6.github.io/blog/" />
  <meta name="twitter:image:src" content="https://nishihi6.github.io/blog/" />




    
    
    
    

    <meta property="og:type" content="article" />
    <meta property="og:article:published_time" content=2024-01-24T04:19:53&#43;0900 />
    <meta property="article:published_time" content=2024-01-24T04:19:53&#43;0900 />

    

    

    <script defer type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "Article",
        "headline": "GameDev #8 入力システム [Devlog #024]",
        "author": {
        "@type": "Person",
        "name": ""
        },
        "datePublished": "2024-01-24",
        "description": "",
        "wordCount":  873 ,
        "mainEntityOfPage": "True",
        "dateModified": "2024-01-24",
        "image": {
        "@type": "imageObject",
        "url": ""
        },
        "publisher": {
        "@type": "Organization",
        "name": "nishihi6"
        }
    }
    </script>


<meta name="generator" content="Hugo 0.117.0">

    

    <link rel="canonical" href="https://nishihi6.github.io/blog/posts/devlog_gl_08/">
    <link href="/blog/style.min.840eada6dfddec7b8ccfcf867f039bf80b1f16a265ec6e01dc553a3dddc9d509.css" rel="stylesheet">
    <link href="/blog/code-highlight.min.706d31975fec544a864cb7f0d847a73ea55ca1df91bf495fd12a177138d807cf.css" rel="stylesheet">

    
    <link rel="apple-touch-icon" sizes="180x180" href="/blog/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/blog/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/blog/icons/favicon-16x16.png">
    <link rel="mask-icon" href="/blog/icons/safari-pinned-tab.svg">
    <link rel="shortcut icon" href="/blog/favicon.ico">




<link rel="manifest" href="https://nishihi6.github.io/blog/site.webmanifest">

<meta name="msapplication-config" content="/blog/browserconfig.xml">
<meta name="msapplication-TileColor" content="#2d89ef">
<meta name="theme-color" content="#434648">

    
    <link rel="icon" type="image/svg+xml" href="/blog/icons/favicon.svg">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css"
    integrity="sha384-vKruj+a13U8yHIkAyGgK1J3ArTLzrFGBbBc0tDp4ad/EyewESeXE/Iv67Aj8gKZ0" crossorigin="anonymous" />


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"
    integrity="sha384-PwRUT/YqbnEjkZO0zZxNqcxACrXe+j766U2amXcgMg5457rve2Y7I6ZJSm2A0mS4"
    crossorigin="anonymous"></script>


<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"
    integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous" onload="renderMathInElement(document.body, {
      delimiters: [
        {left: '$$', right: '$$', display: true},
        {left: '$', right: '$', display: false}
      ]
    });"></script>

    </head>
<body data-theme = "dark" class="notransition">

<script src="/blog/js/theme.min.8961c317c5b88b953fe27525839672c9343f1058ab044696ca225656c8ba2ab0.js" integrity="sha256-iWHDF8W4i5U/4nUlg5ZyyTQ/EFirBEaWyiJWVsi6KrA="></script>

<div class="navbar" role="navigation">
    <nav class="menu" aria-label="Main Navigation">
        <a href="https://nishihi6.github.io/blog/" class="logo">
            <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" 
viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" 
stroke-linejoin="round" class="feather feather-home">
<title>Home</title>
<path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
<polyline points="9 22 9 12 15 12 15 22"></polyline>
</svg>
        </a>
        <input type="checkbox" id="menu-trigger" class="menu-trigger" />
        <label for="menu-trigger">
            <span class="menu-icon">
                <svg xmlns="http://www.w3.org/2000/svg" width="25" height="25" stroke="currentColor" fill="none" viewBox="0 0 14 14"><title>Menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M10.595 7L3.40726 7"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 3.51488L3.49301 3.51488"></path><path stroke-linecap="round" stroke-linejoin="round" d="M10.5096 10.4851H3.49301"></path><path stroke-linecap="round" stroke-linejoin="round" d="M0.5 12.5V1.5C0.5 0.947715 0.947715 0.5 1.5 0.5H12.5C13.0523 0.5 13.5 0.947715 13.5 1.5V12.5C13.5 13.0523 13.0523 13.5 12.5 13.5H1.5C0.947715 13.5 0.5 13.0523 0.5 12.5Z"></path></svg>
            </span>
        </label>

        <div class="trigger">
            <ul class="trigger-container">
                
                
                <li>
                    <a class="menu-link " href="/blog/">
                        Home
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link active" href="/blog/posts/">
                        Posts
                    </a>
                    
                </li>
                
                <li>
                    <a class="menu-link " href="/blog/pages/about/">
                        About
                    </a>
                    
                </li>
                
                <li class="menu-separator">
                    <span>|</span>
                </li>
            </ul>
            <a id="mode" href="#">
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-sunny" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>LIGHT</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
                <svg xmlns="http://www.w3.org/2000/svg" class="mode-moon" width="21" height="21" viewBox="0 0 14 14" stroke-width="1">
<title>DARK</title><g><circle cx="7" cy="7" r="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></circle><line x1="7" y1="0.5" x2="7" y2="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="2.4" x2="3.82" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="0.5" y1="7" x2="2.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="2.4" y1="11.6" x2="3.82" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="7" y1="13.5" x2="7" y2="11.5" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="11.6" x2="10.18" y2="10.18" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="13.5" y1="7" x2="11.5" y2="7" fill="none" stroke-linecap="round" stroke-linejoin="round"></line><line x1="11.6" y1="2.4" x2="10.18" y2="3.82" fill="none" stroke-linecap="round" stroke-linejoin="round"></line></g></svg>
            </a>
        </div>
    </nav>
</div>

<div class="wrapper post">
    <main class="page-content" aria-label="Content">
        <article>
            <header class="header">
                <h1 class="header-title">GameDev #8 入力システム [Devlog #024]</h1>
                
                
                <div class="post-meta">
                    <time datetime="2024-01-24T04:19:53&#43;09:00" itemprop="datePublished"> 24 Jan 2024 </time>
                </div>
                
            </header>
            <details class="toc">
                <summary><b>Table of Contents</b></summary>
                <nav id="TableOfContents">
  <ul>
    <li><a href="#入力システム">入力システム</a>
      <ul>
        <li><a href="#入力システム-1">入力システム</a>
          <ul>
            <li><a href="#ポーリング">ポーリング</a></li>
            <li><a href="#ポジティブエッジとネガティブエッジ">ポジティブエッジとネガティブエッジ</a></li>
            <li><a href="#イベント">イベント</a></li>
            <li><a href="#基礎的なinputsystemのアーキテクチャ">基礎的なInputSystemのアーキテクチャ</a></li>
          </ul>
        </li>
        <li><a href="#キーボード入力">キーボード入力</a>
          <ul>
            <li></li>
          </ul>
        </li>
        <li><a href="#マウス入力">マウス入力</a>
          <ul>
            <li><a href="#ボタンと位置">ボタンと位置</a></li>
            <li><a href="#相対移動">相対移動</a></li>
            <li><a href="#スクロールホイール">スクロールホイール</a></li>
          </ul>
        </li>
        <li><a href="#コントローラー入力">コントローラー入力</a>
          <ul>
            <li><a href="#gamecpp-3">Game.cpp</a></li>
            <li><a href="#gameinitialize-1">Game::Initialize()</a></li>
            <li><a href="#コントローラーを1つだけ使う">コントローラーを1つだけ使う</a></li>
            <li><a href="#ボタン">ボタン</a></li>
            <li><a href="#アナログスティックとトリガー">アナログスティックとトリガー</a></li>
            <li><a href="#アナログスティックを2次元でフィルタリングする">アナログスティックを2次元でフィルタリングする</a></li>
            <li><a href="#複数のコントローラーをサポートする">複数のコントローラーをサポートする</a></li>
          </ul>
        </li>
        <li><a href="#入力のマッピング">入力のマッピング</a></li>
        <li><a href="#ゲームプロジェクト">ゲームプロジェクト</a>
          <ul>
            <li><a href="#shipcpp">Ship.cpp</a></li>
            <li><a href="#shipactorinput">Ship::ActorInput()</a></li>
            <li><a href="#shipupdateactor">Ship::UpdateActor()</a></li>
          </ul>
        </li>
        <li><a href="#まとめ">まとめ</a>
          <ul>
            <li><a href="#参考文献">参考文献</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
            </details><div class="page-content">
                <p>ゲーム開発者の教科書：<a href="https://www.shoeisha.co.jp/book/detail/9784798157610">Game Programming in C++</a> を読んで理解したことについてを要約します（内容の転載を避け、詳しく説明しすぎないように配慮します）</p>
<h1 id="ゲームプログラミング-in-c">ゲームプログラミング in C++</h1>
<hr>
<h2 id="入力システム">入力システム</h2>
<p>ここでは、<strong>入力デバイス</strong>をまとまったシステムに統合させる</p>
<h3 id="入力システム-1">入力システム</h3>
<p>ゲームループの&quot;入力処理&quot;で入力デバイスの現在の状態を取得し、ゲームループの&quot;ゲームワールド更新&quot;でゲームワールドに影響を与える</p>
<h4 id="ポーリング">ポーリング</h4>
<p><code>SDL_GetKeyboardState()</code>で取得した&quot;キーボードの各キーの状態&quot;をアクターの<code>ProcessInput()</code>に渡し、アクターはその状態を各コンポーネントの<code>ProcessInput()</code>に渡す</p>
<p>コンポーネントの<code>ProcessInput()</code>では、フレームごとにキーの値を参照して判定する（<strong>ポーリング</strong>アプローチ（polling:定期的な問い合わせ））</p>
<h4 id="ポジティブエッジとネガティブエッジ">ポジティブエッジとネガティブエッジ</h4>
<p>キャラクターのジャンプを例にすると、</p>
<p>スペースキーの値が1のフレームで必ずキャラクターをジャンプさせるのではなく、スペースキーの<strong>ポジティブエッジ</strong>（positive edge）が立つフレームでだけジャンプさせる</p>
<p><code>spacekeyLast</code>という変数で1つ前のフレームの値を残し、&ldquo;前のフレームの値が0&quot;かつ&quot;現在のフレームの値が1&quot;のときだけジャンプさせる</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// 例
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="n">spacekey</span> <span class="o">==</span> <span class="mi">1</span> <span class="n">and</span> <span class="n">spacekeyLast</span> <span class="o">==</span> <span class="mi">0</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="n">character</span><span class="p">.</span><span class="n">jump</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">spacekeyLast</span> <span class="o">=</span> <span class="n">spacekey</span><span class="p">;</span>
</span></span></code></pre></div><p>前のフレームでの入力値を保存して、現フレームと比較するアプローチを一般化することで、<code>None</code>、<code>Pressed</code>、<code>Released</code>、<code>Held</code>の4種類の状態を簡単に管理できる（生の値もゲームには依然として必要）</p>
<h4 id="イベント">イベント</h4>
<p>毎フレーム<code>Game::ProcessInput()</code>で、イベントがキューにあるのかをチェックし、選択したイベントにだけ応答する</p>
<p>今回は、必要な時にのみSDLイベントを使う（マウスホイールのスクロールなど）</p>
<p><code>SDL_GetKeyboardState()</code>から取得されるキーボード状態が更新されるのは、メッセージポンプのループで<code>SDL_PollEvents()</code>を呼び出したあと</p>
<h4 id="基礎的なinputsystemのアーキテクチャ">基礎的なInputSystemのアーキテクチャ</h4>
<p><code>InputSystem</code>クラスでデータを記録する</p>
<p>アクター・コンポーネントが欲しい情報は、<code>ProseccInput()</code>を経由して<code>InputState</code>のヘルパー関数から得られるようにする</p>
<h5 id="inputsystemh">InputSystem.h</h5>
<p><code>enum ButtonState</code>は4種類の状態を表す</p>
<p>（ <code>class KeyboardState()</code>はキーボード入力に対するヘルパー（※後で詳細を説明） ）</p>
<p>（ <code>struct InputState</code>はキーボード状態のメンバを持つ ）</p>
<p><code>InputSystem</code>クラスでは、<code>Initialize()</code>と<code>Shutdown()</code>を持つ</p>
<p><code>PrepareForUpdate()</code>は<code>SDL_PollEvents()</code>の前に呼び出す</p>
<p><code>Update()</code>は<code>SDL_PollEvents()</code>の後に呼び出す</p>
<p><code>GetState()</code>は、<code>InputState</code>型のメンバ変数<code>mState</code>へのconst参照を返す</p>
<h5 id="gameh">Game.h</h5>
<p><code>InputSystem</code>へのポインタ<code>mInputSystem</code>を追加する</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">InputSystem</span><span class="o">*</span> <span class="n">mInputSystem</span><span class="p">;</span>
</span></span></code></pre></div><h5 id="gamecpp">Game.cpp</h5>
<h5 id="gameinitialize">Game::Initialize()</h5>
<p><code>InputSystem</code>を生成し初期化する</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Initialize input system
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">mInputSystem</span> <span class="o">=</span> <span class="k">new</span> <span class="n">InputSystem</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">mInputSystem</span><span class="o">-&gt;</span><span class="n">Initialize</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">SDL_Log</span><span class="p">(</span><span class="s">&#34;Failed to initialize input system&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h5 id="gameshutdown">Game::Shutdown()</h5>
<p><code>InputSystem</code>をシャットダウンして削除する</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">mInputSystem</span><span class="o">-&gt;</span><span class="n">Shutdown</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="k">delete</span> <span class="n">mInputSystem</span><span class="p">;</span>
</span></span></code></pre></div><h5 id="actorh">Actor.h</h5>
<p><code>ProcessInput()</code>の宣言を変更する</p>
<p>アタッチされたすべてのコンポーネントの<code>ProcessInput()</code>を呼び出すため、オーバーライドできない</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// ProcessInput function called from Game (not overridable)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">void</span> <span class="nf">ProcessInput</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="nc">InputState</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">);</span>
</span></span></code></pre></div><p><code>Actor</code>自身の独自入力のためのオーバーライド可能な<code>ActorInput()</code>の宣言を変更し、<code>InputState</code>のconst参照を受け取るようにする</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Any actor-specific input code (overridable)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">virtual</span> <span class="kt">void</span> <span class="nf">ActorInput</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="nc">InputState</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">);</span>
</span></span></code></pre></div><h5 id="componenth">Component.h</h5>
<p><code>ProcessInput()</code>の宣言を変更する</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Process input for this component
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">virtual</span> <span class="kt">void</span> <span class="nf">ProcessInput</span><span class="p">(</span><span class="k">const</span> <span class="k">struct</span> <span class="nc">InputState</span><span class="o">&amp;</span> <span class="n">state</span><span class="p">)</span> <span class="p">{}</span>
</span></span></code></pre></div><h5 id="gamecpp-1">Game.cpp</h5>
<h5 id="gameprocessinput">Game::ProcessInput()</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">mInputSystem</span><span class="o">-&gt;</span><span class="n">PrepareForUpdate</span><span class="p">();</span>	<span class="c1">// ※
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">SDL_Event</span> <span class="n">event</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="p">(</span><span class="n">SDL_PollEvent</span><span class="p">(</span><span class="o">&amp;</span><span class="n">event</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">switch</span> <span class="p">(</span><span class="n">event</span><span class="p">.</span><span class="n">type</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">case</span> <span class="nl">SDL_QUIT</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">mIsRunning</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">case</span> <span class="nl">SDL_MOUSEWHEEL</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">mInputSystem</span><span class="o">-&gt;</span><span class="n">ProcessEvent</span><span class="p">(</span><span class="n">event</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">			<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mInputSystem</span><span class="o">-&gt;</span><span class="n">Update</span><span class="p">();</span>	<span class="c1">// ※
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">const</span> <span class="n">InputState</span><span class="o">&amp;</span> <span class="n">state</span> <span class="o">=</span> <span class="n">mInputSystem</span><span class="o">-&gt;</span><span class="n">GetState</span><span class="p">();</span>	<span class="c1">// ※
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="n">Keyboard</span><span class="p">.</span><span class="n">GetKeyState</span><span class="p">(</span><span class="n">SDL_SCANCODE_ESCAPE</span><span class="p">)</span> <span class="o">==</span> <span class="n">EReleased</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">mIsRunning</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">mUpdatingActors</span> <span class="o">=</span> <span class="nb">true</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="p">(</span><span class="k">auto</span> <span class="nl">actor</span> <span class="p">:</span> <span class="n">mActors</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">actor</span><span class="o">-&gt;</span><span class="n">ProcessInput</span><span class="p">(</span><span class="n">state</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">mUpdatingActors</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</span></span></code></pre></div><p>以上が<code>InputSystem</code>が入力デバイスをサポートするのに必要な基本部分になる</p>
<p>後ほど、デバイスごとに状態をカプセル化する新しいクラスを追加し、そのクラスのインスタンスを<code>InputState</code>構造体に追加する</p>
<h3 id="キーボード入力">キーボード入力</h3>
<h5 id="inputsystemh-1">InputSystem.h</h5>
<h5 id="class-keyboardstate">class KeyboardState</h5>
<p>現在の状態を指すポインタ<code>mCurrState</code>と、1つ前の状態を保存する配列<code>mPrevState[SDL_NUM_SCANCODES]</code>を追加する（<code>SDL_NUM_SCANCODES</code>はSDLがキーボードを管理するバッファサイズ）</p>
<p><code>GetKeyValue()</code>はキーの現在値をbool値で返す</p>
<p><code>GetKeyState()</code>は4種のボタン状態を返す</p>
<p>クラス<code>InputSystem</code>をfriendにして、<code>InputSystem</code>が<code>KeyboardState</code>のメンバを操作しやすくする</p>
<p>メンバデータ<code>struct InputState</code>に<code>KeyboardState</code>のインスタンスである<code>Keyboard</code>を追加する</p>
<h5 id="inputsystemcpp">InputSystem.cpp</h5>
<h5 id="inputsysteminitialize">InputSystem::Initialize()</h5>
<p><code>mCurrState</code>ポインタを設定し、<code>mPrevState</code>のメモリをゼロクリアする</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Keyboard
</span></span></span><span class="line"><span class="cl"><span class="c1">// Assign current state pointer
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">mState</span><span class="p">.</span><span class="n">Keyboard</span><span class="p">.</span><span class="n">mCurrState</span> <span class="o">=</span> <span class="n">SDL_GetKeyboardState</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Clear previous state memory
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">memset</span><span class="p">(</span><span class="n">mState</span><span class="p">.</span><span class="n">Keyboard</span><span class="p">.</span><span class="n">mPrevState</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SDL_NUM_SCANCODES</span><span class="p">);</span>
</span></span></code></pre></div><h5 id="inputsystemprepareforupdate">InputSystem::PrepareForUpdate()</h5>
<p>現在の状態を&quot;前回のバッファ&quot;にコピーする（<code>SDL_PollEvents()</code>の呼び出し前に）</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Copy current state to previous
</span></span></span><span class="line"><span class="cl"><span class="c1">// Keyboard
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">memcpy</span><span class="p">(</span><span class="n">mState</span><span class="p">.</span><span class="n">Keyboard</span><span class="p">.</span><span class="n">mPrevState</span><span class="p">,</span> <span class="n">mState</span><span class="p">.</span><span class="n">Keyboard</span><span class="p">.</span><span class="n">mCurrState</span><span class="p">,</span> <span class="n">SDL_NUM_SCANCODES</span><span class="p">);</span>
</span></span></code></pre></div><h5 id="keyboardstategetkeyvalue">KeyboardState::GetKeyValue()</h5>
<p><code>mCurrState</code>バッファををインデックス参照して、値が1ならtrue、0ならfalseを返す</p>
<h5 id="keyboardstategetkeystate">KeyboardState::GetKeyState()</h5>
<p>現在のフレームと前のフレームのキーの状態から、4種類のボタン状態を判定する</p>
<h3 id="マウス入力">マウス入力</h3>
<p>ポジション入力には絶対と相対の2つのモードがある</p>
<p>SDLは、スクロールホイールのデータをイベント経由でしか渡さない</p>
<p>カーソル表示は、<code>SDL_ShowCursor()</code>で制御する</p>
<h4 id="ボタンと位置">ボタンと位置</h4>
<p><code>SDL_GetMouseState()</code>は、マウスの位置とボタンの状態を取得する（戻り値のビット列がボタンの状態を示し、渡すint型変数が座標を示す）</p>
<p>SDLの2次元座標系では左上隅が<code>(0, 0)</code>になる</p>
<p><code>buttons</code>変数が取得されている時、左マウスボタンが押されている場合、<code>leftIsDown</code>はtrueになる</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">Uint32</span> <span class="n">buttons</span> <span class="o">=</span> <span class="n">SDL_GetMouseState</span><span class="p">(</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">);</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="kt">bool</span> <span class="n">leftIsDown</span> <span class="o">=</span> <span class="p">(</span><span class="n">buttons</span> <span class="o">&amp;</span> <span class="n">SDL_BUTTON</span><span class="p">(</span><span class="n">SDL_BUTTON_LEFT</span><span class="p">))</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">;</span>
</span></span></code></pre></div><p><code>SDL_BUTTON()</code>マクロは、ボタン定数に基づいて1をビットシフトする<br>（<code>SDL_BUTTON(SDL_BUTTON_LEFT)</code>は、<code>1 &lt;&lt; ((1)-1)</code>で<code>0x0001</code>）<br>（<code>SDL_BUTTON(SDL_BUTTON_MIDDLE)</code>は、<code>1 &lt;&lt; ((2)-1)</code>で<code>0x0002</code>）</p>
<h5 id="class-mousestate">class MouseState</h5>
<p>32ビット符号なし整数でボタンの状態（現在<code>mCurrButtons</code>と1つ前<code>mPrevButtons</code>）を保存</p>
<p><code>Vector2</code>でマウスポジション<code>mMousePos</code>を保存する</p>
<p>クラス<code>InputSystem</code>をfriendにして、<code>InputSystem</code>が<code>MouseState</code>のメンバを操作しやすくする</p>
<p>メンバデータ<code>struct InputState</code>に<code>MouseState</code>インスタンスの<code>Mouse</code>を追加</p>
<h5 id="inputsystemcpp-1">InputSystem.cpp</h5>
<h5 id="inputsysteminitialize-1">InputSystem::Initialize()</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Mouse (just set everything to 0)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">mState</span><span class="p">.</span><span class="n">Mouse</span><span class="p">.</span><span class="n">mCurrButtons</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">mState</span><span class="p">.</span><span class="n">Mouse</span><span class="p">.</span><span class="n">mPrevButtons</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span></code></pre></div><h5 id="inputsystemprepareforupdate-1">InputSystem::PrepareForUpdate()</h5>
<p>現在のボタン状態を&quot;1つ前のボタン状態&quot;にコピーする</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Mouse
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">mState</span><span class="p">.</span><span class="n">Mouse</span><span class="p">.</span><span class="n">mPrevButtons</span> <span class="o">=</span> <span class="n">mState</span><span class="p">.</span><span class="n">Mouse</span><span class="p">.</span><span class="n">mCurrButtons</span><span class="p">;</span>
</span></span></code></pre></div><h5 id="inputsystemupdate">InputSystem::Update()</h5>
<p><code>SDL_GetMouseState()</code>で<code>MouseState</code>のすべてのメンバを更新する</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Mouse
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">mState</span><span class="p">.</span><span class="n">Mouse</span><span class="p">.</span><span class="n">mCurrButtons</span> <span class="o">=</span> <span class="n">SDL_GetMouseState</span><span class="p">(</span><span class="o">&amp;</span><span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">mState</span><span class="p">.</span><span class="n">Mouse</span><span class="p">.</span><span class="n">mMousePos</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">mState</span><span class="p">.</span><span class="n">Mouse</span><span class="p">.</span><span class="n">mMousePos</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
</span></span></code></pre></div><h4 id="相対移動">相対移動</h4>
<p>SDLには、<strong>相対</strong>（relative）マウスモードがサポートされており、<code>GetRelativeMouseState()</code>を2回呼び出す間に発生した移動量を取得できる</p>
<p>相対マウスモードでは、マウスポインタを隠し、ウィンドウ内にマウスをロックし、フレームごとにマウスをセンタリングする</p>
<h5 id="inputsystemcpp-2">InputSystem.cpp</h5>
<h5 id="inputsystemsetrelativemousemode">InputSystem::SetRelativeMouseMode()</h5>
<p>相対マウスモードの有効/無効を切り替える</p>
<p><code>MouseState</code>のbool型変数である<code>mIsRelative</code>は、相対マウスモードの状態を表す</p>
<h5 id="inputsystemupdate-1">InputSystem::Update()</h5>
<p>モードに応じてマウス入力の関数を使い分ける</p>
<h4 id="スクロールホイール">スクロールホイール</h4>
<p>SDLは、スクロールホイールの状態をポーリングする関数を提供せず、<code>SDL_MOUSEWHEEL</code>イベントを呼び出す</p>
<h5 id="gamecpp-2">Game.cpp</h5>
<h5 id="gameprocessinput-1">Game::ProcessInput()</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">SDL_Event</span> <span class="n">event</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="p">(</span><span class="n">SDL_PollEvent</span><span class="p">(</span><span class="o">&amp;</span><span class="n">event</span><span class="p">))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">switch</span> <span class="p">(</span><span class="n">event</span><span class="p">.</span><span class="n">type</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="k">case</span> <span class="nl">SDL_QUIT</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">mIsRunning</span> <span class="o">=</span> <span class="nb">false</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">			<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">case</span> <span class="nl">SDL_MOUSEWHEEL</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">			<span class="n">mInputSystem</span><span class="o">-&gt;</span><span class="n">ProcessEvent</span><span class="p">(</span><span class="n">event</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">			<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">		<span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">			<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h5 id="inputsystemh-2">InputSystem.h</h5>
<h5 id="class-mousestate-1">class MouseState</h5>
<p>垂直と水平方向のスクロールを保存するメンバ変数<code>mScrollWheel</code>を追加する</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Motion of scroll wheel
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Vector2</span> <span class="n">mScrollWheel</span><span class="p">;</span>
</span></span></code></pre></div><h5 id="inputsystemcpp-3">InputSystem.cpp</h5>
<h5 id="inputsystemprocessevent">InputSystem::ProcessEvent()</h5>
<p><code>event.wheel</code>構造体からスクロールホイールのx、y値を取得する</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">switch</span> <span class="p">(</span><span class="n">event</span><span class="p">.</span><span class="n">type</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="k">case</span> <span class="nl">SDL_MOUSEWHEEL</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">		<span class="n">mState</span><span class="p">.</span><span class="n">Mouse</span><span class="p">.</span><span class="n">mScrollWheel</span> <span class="o">=</span> <span class="n">Vector2</span><span class="p">(</span><span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">event</span><span class="p">.</span><span class="n">wheel</span><span class="p">.</span><span class="n">x</span><span class="p">),</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">event</span><span class="p">.</span><span class="n">wheel</span><span class="p">.</span><span class="n">y</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="k">default</span><span class="o">:</span>
</span></span><span class="line"><span class="cl">		<span class="k">break</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h5 id="inputsystemprepareforupdate-2">InputSystem::PrepareForUpdate()</h5>
<p><code>mScrollWheel</code>変数をクリアする</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">mState</span><span class="p">.</span><span class="n">Mouse</span><span class="p">.</span><span class="n">mScrollWheel</span> <span class="o">=</span> <span class="n">Vector2</span><span class="o">::</span><span class="n">Zero</span><span class="p">;</span>
</span></span></code></pre></div><h3 id="コントローラー入力">コントローラー入力</h3>
<p>コントローラーを使う前に、SDLサブシステムを初期化する必要がある</p>
<h4 id="gamecpp-3">Game.cpp</h4>
<h4 id="gameinitialize-1">Game::Initialize()</h4>
<p><code>SDL_INIT_GAMECONTROLLER</code>フラグを追加する</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="n">SDL_Init</span><span class="p">(</span><span class="n">SDL_INIT_VIDEO</span><span class="o">|</span><span class="n">SDL_INIT_AUDIO</span><span class="o">|</span><span class="n">SDL_INIT_GAMECONTROLLER</span><span class="p">);</span>
</span></span></code></pre></div><h4 id="コントローラーを1つだけ使う">コントローラーを1つだけ使う</h4>
<h5 id="inputsystemh-3">InputSystem.h</h5>
<p><code>SDL_GameController*</code>ポインタのメンバ変数<code>mController</code>を追加する</p>
<h5 id="inputsystemcpp-4">InputSystem.cpp</h5>
<h5 id="inputsysteminitialize-2">InputSystem::Initialize()</h5>
<p><code>SDL_GameControllerOpen()</code>でコントローラーを初期化して、<code>mController</code>に<code>SDL_GameController</code>構造体へのポインタを返す</p>
<p><code>DL_GameControllerOpen(0)</code>でコントローラー0をオープンする</p>
<p>※ サポート外のコントローラーは、<code>SDL_GameControllerAddMappingsFromFile()</code>を使って、ファイルからコントローラーマッピングの設定を行って対応する <a href="https://github.com/gabomdq/SDL_GameControllerDB">https://github.com/gabomdq/SDL_GameControllerDB</a></p>
<h4 id="ボタン">ボタン</h4>
<p>SDLは、<code>SDL_GameControllerGetButton()</code>で、それぞれのボタンを個別に問い合わせる必要がある</p>
<h5 id="inputsystemh-4">InputSystem.h</h5>
<h5 id="class-controllerstate">class ControllerState</h5>
<p>現在と1つ前のボタン状態を保存する配列<code>mCurrButtons[]</code>と<code>mPrevButtons[]</code>を用意する</p>
<p><code>mIsConnected</code>は、コントローラーが接続されているかを示す</p>
<p>クラス<code>InputSystem</code>をfriendにして、<code>InputSystem</code>が<code>ControllerState</code>のメンバを操作しやすくする</p>
<p>メンバデータ<code>struct InputState</code>に<code>ControllerState</code>インスタンスの<code>Controller</code>を追加</p>
<h5 id="inputsystemcpp-5">InputSystem.cpp</h5>
<h5 id="inputsysteminitialize-3">InputSystem::Initialize()</h5>
<p>コントローラー0をオープンした後、<code>mIsConnected</code>変数に<code>mController</code>ポインタのnullptr判定に基づく真偽値をセットする</p>
<p><code>mCurrButtons</code>と<code>mPrevButtons</code>のメモリをクリアする</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Get the connected controller, if it exists
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">mController</span> <span class="o">=</span> <span class="n">SDL_GameControllerOpen</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Initialize controller state
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">mState</span><span class="p">.</span><span class="n">Controller</span><span class="p">.</span><span class="n">mIsConnected</span> <span class="o">=</span> <span class="p">(</span><span class="n">mController</span> <span class="o">!=</span> <span class="k">nullptr</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">memset</span><span class="p">(</span><span class="n">mState</span><span class="p">.</span><span class="n">Controller</span><span class="p">.</span><span class="n">mCurrButtons</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SDL_CONTROLLER_BUTTON_MAX</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">memset</span><span class="p">(</span><span class="n">mState</span><span class="p">.</span><span class="n">Controller</span><span class="p">.</span><span class="n">mPrevButtons</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">SDL_CONTROLLER_BUTTON_MAX</span><span class="p">);</span>
</span></span></code></pre></div><h5 id="inputsystemprepareforupdate-3">InputSystem::PrepareForUpdate()</h5>
<p>現在のボタン状態を&quot;1つ前のボタン状態&quot;にコピーする</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Controller
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">memcpy</span><span class="p">(</span><span class="n">mState</span><span class="p">.</span><span class="n">Controller</span><span class="p">.</span><span class="n">mPrevButtons</span><span class="p">,</span> <span class="n">mState</span><span class="p">.</span><span class="n">Controller</span><span class="p">.</span><span class="n">mCurrButtons</span><span class="p">,</span> <span class="n">SDL_CONTROLLER_BUTTON_MAX</span><span class="p">);</span>
</span></span></code></pre></div><h5 id="inputsystemupdate-2">InputSystem::Update()</h5>
<p>各ボタンの状態を問い合わせて<code>mCurrButtons</code>配列に格納する</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Controller
</span></span></span><span class="line"><span class="cl"><span class="c1">// Buttons
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">SDL_CONTROLLER_BUTTON_MAX</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">mState</span><span class="p">.</span><span class="n">Controller</span><span class="p">.</span><span class="n">mCurrButtons</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">SDL_GameControllerGetButton</span><span class="p">(</span><span class="n">mController</span><span class="p">,</span> <span class="n">SDL_GameControllerButton</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="アナログスティックとトリガー">アナログスティックとトリガー</h4>
<p>SDLは合計6つの軸をサポートする（2つの2軸アナログスティックと、2つの1軸トリガー）</p>
<p>トリガーの値の範囲は0~32767で、アナログスティックの値の範囲は-32768~32767である（$y$軸正は下、$x$軸正は右）</p>
<p>デバイスごとの<strong>不正確さ</strong>を考慮し、勝手な入力 = <strong>ファントム入力</strong>（phantom input）などが発生しないように、軸からの入力にフィルターをかけて遊びをいれる（デッドゾーン）</p>
<h5 id="inputsystemcpp-6">InputSystem.cpp</h5>
<h5 id="inputsystemfilter1d">InputSystem::Filter1D()</h5>
<p>デッドゾーンと最大値のための定数値<code>deadZone</code>と<code>maxValue</code>を宣言する（必要であればユーザー設定値にする）</p>
<p>三項演算子を使って入力の絶対値を取得し、値に応じて-1.0fから1.0fまでの範囲にクランプする</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// A value &lt; dead zone is interpreted as 0%
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">const</span> <span class="kt">int</span> <span class="n">deadZone</span> <span class="o">=</span> <span class="mi">250</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// A value &gt; max value is interpreted as 100%
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">const</span> <span class="kt">int</span> <span class="n">maxValue</span> <span class="o">=</span> <span class="mi">30000</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">float</span> <span class="n">retVal</span> <span class="o">=</span> <span class="mf">0.0f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Take absolute value of input
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">int</span> <span class="n">absValue</span> <span class="o">=</span> <span class="n">input</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="nl">input</span> <span class="p">:</span> <span class="o">-</span><span class="n">input</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="c1">// Ignore input within dead zone
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="n">absValue</span> <span class="o">&gt;</span> <span class="n">deadZone</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Compute fractional value between dead zone and max value
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">retVal</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">absValue</span> <span class="o">-</span> <span class="n">deadZone</span><span class="p">)</span> <span class="o">/</span>
</span></span><span class="line"><span class="cl">	<span class="p">(</span><span class="n">maxValue</span> <span class="o">-</span> <span class="n">deadZone</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Make sure sign matches original value
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">retVal</span> <span class="o">=</span> <span class="n">input</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">?</span> <span class="nl">retVal</span> <span class="p">:</span> <span class="o">-</span><span class="mf">1.0f</span> <span class="o">*</span> <span class="n">retVal</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Clamp between -1.0f and 1.0f
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">retVal</span> <span class="o">=</span> <span class="n">Math</span><span class="o">::</span><span class="n">Clamp</span><span class="p">(</span><span class="n">retVal</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0f</span><span class="p">,</span> <span class="mf">1.0f</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="n">retVal</span><span class="p">;</span>
</span></span></code></pre></div><h5 id="inputsystemh-5">InputSystem.h</h5>
<h5 id="class-controllerstate-1">class ControllerState</h5>
<p>左右それぞれの1軸トリガーのために、2つのfloat型変数を追加する</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Left/right trigger
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">float</span> <span class="n">mLeftTrigger</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">float</span> <span class="n">mRightTrigger</span><span class="p">;</span>
</span></span></code></pre></div><h5 id="inputsystemcpp-7">InputSystem.cpp</h5>
<h5 id="inputsystemupdate-3">InputSystem::Update()</h5>
<p><code>SDL_GameControllerGetAxis()</code>で取得した値を<code>Filter1D()</code>で0.0fから1.0fまでの範囲に変換する</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Triggers
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">mState</span><span class="p">.</span><span class="n">Controller</span><span class="p">.</span><span class="n">mLeftTrigger</span> <span class="o">=</span> <span class="n">Filter1D</span><span class="p">(</span><span class="n">SDL_GameControllerGetAxis</span><span class="p">(</span><span class="n">mController</span><span class="p">,</span> <span class="n">SDL_CONTROLLER_AXIS_TRIGGERLEFT</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"><span class="n">mState</span><span class="p">.</span><span class="n">Controller</span><span class="p">.</span><span class="n">mRightTrigger</span> <span class="o">=</span> <span class="n">Filter1D</span><span class="p">(</span><span class="n">SDL_GameControllerGetAxis</span><span class="p">(</span><span class="n">mController</span><span class="p">,</span> <span class="n">SDL_CONTROLLER_AXIS_TRIGGERRIGHT</span><span class="p">));</span>
</span></span></code></pre></div><h4 id="アナログスティックを2次元でフィルタリングする">アナログスティックを2次元でフィルタリングする</h4>
<p>アナログスティックの場合、<code>Filter1D</code>を独立して$x,y$軸に適用するのではなく、2次元の入力を同心円として解釈する（2次元のベクトルを作り、そのベクトルの長さを計算する）</p>
<p>デッドゾーンよりも長さが短ければ<code>Vector2::Zero</code>、長ければデッドゾーンと最大値の間で小数値を求める</p>
<h5 id="inputsystemcpp-8">InputSystem.cpp</h5>
<h5 id="inputsystemfilter2d">InputSystem::Filter2D()</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">float</span> <span class="n">deadZone</span> <span class="o">=</span> <span class="mf">8000.0f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">float</span> <span class="n">maxValue</span> <span class="o">=</span> <span class="mf">30000.0f</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Make into 2D vector
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Vector2</span> <span class="n">dir</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">dir</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">inputX</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">dir</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="k">static_cast</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">inputY</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">float</span> <span class="n">length</span> <span class="o">=</span> <span class="n">dir</span><span class="p">.</span><span class="n">Length</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// If length &lt; deadZone, should be no input
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">if</span> <span class="p">(</span><span class="n">length</span> <span class="o">&lt;</span> <span class="n">deadZone</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">dir</span> <span class="o">=</span> <span class="n">Vector2</span><span class="o">::</span><span class="n">Zero</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Calculate fractional value between
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// dead zone and max value circles
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="kt">float</span> <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">length</span> <span class="o">-</span> <span class="n">deadZone</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">maxValue</span> <span class="o">-</span> <span class="n">deadZone</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Clamp f between 0.0f and 1.0f
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">f</span> <span class="o">=</span> <span class="n">Math</span><span class="o">::</span><span class="n">Clamp</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="mf">0.0f</span><span class="p">,</span> <span class="mf">1.0f</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="c1">// Normalize the vector, and then scale it to the
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="c1">// fractional value
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>	<span class="n">dir</span> <span class="o">*=</span> <span class="n">f</span> <span class="o">/</span> <span class="n">length</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">return</span> <span class="n">dir</span><span class="p">;</span>
</span></span></code></pre></div><h5 id="inputsystemh-6">InputSystem.h</h5>
<h5 id="class-controllerstate-2">class ControllerState</h5>
<p>左右2つの2軸アナログスティックのため、2つのVector2型変数を追加する</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Left/right sticks
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Vector2</span> <span class="n">mLeftStick</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">Vector2</span> <span class="n">mRightStick</span><span class="p">;</span>
</span></span></code></pre></div><h5 id="inputsystemcpp-9">InputSystem.cpp</h5>
<h5 id="inputsystemupdate-4">InputSystem::Update()</h5>
<p>アナログスティックの値を取得し、<code>Filter2D()</code>で最終的な値を求める</p>
<p>$y$軸の正負を逆にする（+$y$を上方とする）</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Sticks
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">x</span> <span class="o">=</span> <span class="n">SDL_GameControllerGetAxis</span><span class="p">(</span><span class="n">mController</span><span class="p">,</span> <span class="n">SDL_CONTROLLER_AXIS_LEFTX</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">SDL_GameControllerGetAxis</span><span class="p">(</span><span class="n">mController</span><span class="p">,</span> <span class="n">SDL_CONTROLLER_AXIS_LEFTY</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">mState</span><span class="p">.</span><span class="n">Controller</span><span class="p">.</span><span class="n">mLeftStick</span> <span class="o">=</span> <span class="n">Filter2D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">x</span> <span class="o">=</span> <span class="n">SDL_GameControllerGetAxis</span><span class="p">(</span><span class="n">mController</span><span class="p">,</span> <span class="n">SDL_CONTROLLER_AXIS_RIGHTX</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">y</span> <span class="o">=</span> <span class="o">-</span><span class="n">SDL_GameControllerGetAxis</span><span class="p">(</span><span class="n">mController</span><span class="p">,</span> <span class="n">SDL_CONTROLLER_AXIS_RIGHTY</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">mState</span><span class="p">.</span><span class="n">Controller</span><span class="p">.</span><span class="n">mRightStick</span> <span class="o">=</span> <span class="n">Filter2D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
</span></span></code></pre></div><h4 id="複数のコントローラーをサポートする">複数のコントローラーをサポートする</h4>
<p>すべてのジョイスティックをループ処理し、どれがコントローラーかを調べ、個々のコントローラーをオープンする</p>
<p>当プロジェクトでは実装しない</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">SDL_NumJoysticks</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span><span class="p">(</span><span class="n">SDL_IsGameController</span><span class="p">(</span><span class="n">i</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">		<span class="n">SDL_GameController</span><span class="o">*</span> <span class="n">controller</span> <span class="o">=</span> <span class="n">SDL_GameControllerOpen</span><span class="p">(</span><span class="n">i</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>ホワイトスワップ（コントローラーの抜き差し）をサポートする際は、SDLがイベント<code>SDL_CONTROLLERDEVICEADDED</code>と<code>SDL_CONTROLLERDEVICEMOVED</code>を生成することを利用する</p>
<h3 id="入力のマッピング">入力のマッピング</h3>
<p>抽象的なアクションと、そのアクションに対応する{デバイス, ボタン}ペアの連想配列を用意することが理想</p>
<p>さらに、複数バインディングを同じ抽象アクションに許すようにしたい</p>
<p>これにより、AI制御のキャラクターのアクション実行が容易になるほか、キーボードとコントローラーの&quot;軸に沿った&quot;動きを定義できる</p>
<p>ファイルからマッピングを読み込む機構も追加することで、マッピングをユーザーが定義できるようになる</p>
<h3 id="ゲームプロジェクト">ゲームプロジェクト</h3>
<p><a href="https://nishihi6.github.io/blog/posts/devlog_gl_05/">Devlog #019</a>での実装に<code>InputSystem</code>を追加実装する</p>
<h4 id="shipcpp">Ship.cpp</h4>
<h4 id="shipactorinput">Ship::ActorInput()</h4>
<p>左右のアナログスティックから値を取得し、メンバ変数に保存する</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="n">Controller</span><span class="p">.</span><span class="n">GetIsConnected</span><span class="p">())</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">mVelocityDir</span> <span class="o">=</span> <span class="n">state</span><span class="p">.</span><span class="n">Controller</span><span class="p">.</span><span class="n">GetLeftStick</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="n">Math</span><span class="o">::</span><span class="n">NearZero</span><span class="p">(</span><span class="n">state</span><span class="p">.</span><span class="n">Controller</span><span class="p">.</span><span class="n">GetRightStick</span><span class="p">().</span><span class="n">Length</span><span class="p">()))</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">mRotationDir</span> <span class="o">=</span> <span class="n">state</span><span class="p">.</span><span class="n">Controller</span><span class="p">.</span><span class="n">GetRightStick</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><h4 id="shipupdateactor">Ship::UpdateActor()</h4>
<p>速度の方向に基づいてアクターを動かす</p>
<p><code>mVelocityDir</code>が1未満の長さの場合、減速する</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Update position based on velocity
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">Vector2</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">GetPosition</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="n">pos</span> <span class="o">+=</span> <span class="n">mVelocityDir</span> <span class="o">*</span> <span class="n">mSpeed</span> <span class="o">*</span> <span class="n">deltaTime</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">SetPosition</span><span class="p">(</span><span class="n">pos</span><span class="p">);</span>
</span></span></code></pre></div><p>アクターを回転させる</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-cpp" data-lang="cpp"><span class="line"><span class="cl"><span class="c1">// Update rotation
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kt">float</span> <span class="n">angle</span> <span class="o">=</span> <span class="n">Math</span><span class="o">::</span><span class="n">Atan2</span><span class="p">(</span><span class="n">mRotationDir</span><span class="p">.</span><span class="n">y</span><span class="p">,</span> <span class="n">mRotationDir</span><span class="p">.</span><span class="n">x</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="n">SetRotation</span><span class="p">(</span><span class="n">angle</span><span class="p">);</span>
</span></span></code></pre></div><p>※ 3次元で使ったクォータニオンによる回転ではなく、角度に1個のfloatを使う2次元のアクタークラスであるため実行可能となる</p>
<h3 id="まとめ">まとめ</h3>
<h4 id="参考文献">参考文献</h4>
<p>入力を記録して再生する方法についての記事：<br><a href="https://www.amazon.com/Game-Programming-Gems-GAME-PROGRAMMING/dp/1584500549">&ldquo;Game Input Recording and Playback.&ldquo;Game Programming Gems 2</a></p>
<p>Oculus SDKのドキュメント：<br><a href="https://developer.oculus.com/documentation/native/pc/pcsdk-intro/?locale=ja_JP">Oculus PC SDK.</a></p>
<p>入力ラグの計測方法について：<br><a href="https://www.gamedeveloper.com/game-platforms/feature-measuring-responsiveness-in-video-games-#close-modal">&ldquo;Programming Responsiveness.&rdquo;</a></p>

            </div>
        </article></main>
</div>
<footer class="footer">
    <span class="footer_item"> </span>
    &nbsp;

    <div class="footer_social-icons">
<a href="https://github.com/nishihi6" target="_blank" rel="noopener noreferrer me"
    title="Github">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path
        d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22">
    </path>
</svg>
</a>
<a href="https://www.facebook.com/profile.php?id=100034856812491" target="_blank" rel="noopener noreferrer me"
    title="Facebook">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"></path>
</svg>
</a>
<a href="https://twitter.com" target="_blank" rel="noopener noreferrer me"
    title="X">
    <svg viewBox="0 0 1200 1227" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
    <path
        d="M714.163 519.284L1160.89 0H1055.03L667.137 450.887L357.328 0H0L468.492 681.821L0 1226.37H105.866L515.491 750.218L842.672 1226.37H1200L714.137 519.284H714.163ZM569.165 687.828L521.697 619.934L144.011 79.6944H306.615L611.412 515.685L658.88 583.579L1055.08 1150.3H892.476L569.165 687.854V687.828Z"/>
</svg>
</a>
<a href="https://connpass.com/user/nishihi6/" target="_blank" rel="noopener noreferrer me"
    title="Connpass">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
    <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
</svg>
</a>
<a href="http://www.igl.ise.shibaura-it.ac.jp/" target="_blank" rel="noopener noreferrer me"
    title="Lab">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
    <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
</svg>
</a>
<a href="index.xml" target="_blank" rel="noopener noreferrer me"
    title="Rss">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
    stroke-linecap="round" stroke-linejoin="round">
    <path d="M4 11a9 9 0 0 1 9 9" />
    <path d="M4 4a16 16 0 0 1 16 16" />
    <circle cx="5" cy="19" r="1" />
</svg>
</a>
</div>
    <small class="footer_copyright">
        © 2024 nishihi6.
    </small>
    
</footer><a href="#" title="Go to top" id="totop">
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor" stroke="currentColor" viewBox="0 96 960 960">
    <path d="M283 704.739 234.261 656 480 410.261 725.739 656 677 704.739l-197-197-197 197Z"/>
</svg>

</a>


    




    
    
        
    

    
    
        
    



    
    <script src="https://nishihi6.github.io/blog/js/main.min.35f435a5d8eac613c52daa28d8af544a4512337d3e95236e4a4978417b8dcb2f.js" integrity="sha256-NfQ1pdjqxhPFLaoo2K9USkUSM30&#43;lSNuSkl4QXuNyy8="></script>

    

</body>
</html>
